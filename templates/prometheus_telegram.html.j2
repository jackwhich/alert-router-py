ğŸ“Š æ¥æº: {% if labels._source == 'grafana' %}Grafana{% else %}Prometheus{% endif %}


{% if status == "firing" -%}
ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ çŠ¶æ€: å‘Šè­¦
{%- else -%}
âœ…âœ…âœ…âœ…âœ…âœ… çŠ¶æ€: æ¢å¤
{% endif %}


æ—¶é—´: {{ startsAt }}

{% for key, value in labels.items() -%}
{% if key not in ['prometheus', 'id', 'image', 'uid', 'metrics_path', 'endpoint', 'job', 'service', 'name', '_source', '_receiver', 'replicas', 'pods', '_pod_values', '_entity_values', 'instances', 'service_names', 'consumergroups', 'topics', 'jenkins_jobs', 'devices', 'containers', 'build_numbers'] -%}
{{ key }}: {{ value }}
{% endif %}
{% endfor %}

{# æ˜¾ç¤ºæ‰€æœ‰å®ä½“ç±»å‹åŠå…¶å€¼ #}
{% set entity_values = labels.get('_entity_values', {}) %}
{% if entity_values -%}
{# Pod å®ä½“ #}
{% if labels.get('pods') -%}
{% for pod in (labels.pods | unique | sort) -%}
pod: {{ pod }}{% if entity_values.get('pod:' + pod) %} (å€¼: {{ entity_values.get('pod:' + pod) }}){% endif %}
{% endfor %}
{% endif %}
{# Instance å®ä½“ï¼ˆNode Exporter, Nginxç­‰ï¼‰ #}
{% if labels.get('instances') -%}
{% for instance in (labels.instances | unique | sort) -%}
instance: {{ instance }}{% if entity_values.get('instance:' + instance) %} (å€¼: {{ entity_values.get('instance:' + instance) }}){% endif %}
{% endfor %}
{% endif %}
{# Service Name å®ä½“ï¼ˆRPCæœåŠ¡ï¼‰ #}
{% if labels.get('service_names') -%}
{% for service_name in (labels.service_names | unique | sort) -%}
service_name: {{ service_name }}{% if entity_values.get('service_name:' + service_name) %} (å€¼: {{ entity_values.get('service_name:' + service_name) }}){% endif %}
{% endfor %}
{% endif %}
{# Kafka æ¶ˆè´¹ç»„ #}
{% if labels.get('consumergroups') -%}
{% for consumergroup in (labels.consumergroups | unique | sort) -%}
consumergroup: {{ consumergroup }}{% if entity_values.get('consumergroup:' + consumergroup) %} (å€¼: {{ entity_values.get('consumergroup:' + consumergroup) }}){% endif %}
{% endfor %}
{% endif %}
{# Kafka ä¸»é¢˜ #}
{% if labels.get('topics') -%}
{% for topic in (labels.topics | unique | sort) -%}
topic: {{ topic }}{% if entity_values.get('topic:' + topic) %} (å€¼: {{ entity_values.get('topic:' + topic) }}){% endif %}
{% endfor %}
{% endif %}
{# Jenkins ä»»åŠ¡ #}
{% if labels.get('jenkins_jobs') -%}
{% for jenkins_job in (labels.jenkins_jobs | unique | sort) -%}
jenkins_job: {{ jenkins_job }}{% if entity_values.get('jenkins_job:' + jenkins_job) %} (å€¼: {{ entity_values.get('jenkins_job:' + jenkins_job) }}){% endif %}
{% endfor %}
{% endif %}
{# Device å®ä½“ï¼ˆç£ç›˜ç­‰ï¼‰ #}
{% if labels.get('devices') -%}
{% for device in (labels.devices | unique | sort) -%}
device: {{ device }}{% if entity_values.get('device:' + device) %} (å€¼: {{ entity_values.get('device:' + device) }}){% endif %}
{% endfor %}
{% endif %}
{# Container å®ä½“ #}
{% if labels.get('containers') -%}
{% for container in (labels.containers | unique | sort) -%}
container: {{ container }}{% if entity_values.get('container:' + container) %} (å€¼: {{ entity_values.get('container:' + container) }}){% endif %}
{% endfor %}
{% endif %}
{# Replica å®ä½“ #}
{% if labels.get('replicas') -%}
replica: {{ (labels.replicas | unique | sort) | join(', ') }}
{% endif %}
{%- else -%}
{# å¦‚æœæ²¡æœ‰ entity_valuesï¼Œä½¿ç”¨æ—§çš„æ˜¾ç¤ºæ–¹å¼ï¼ˆå‘åå…¼å®¹ï¼‰ #}
{% if labels.get('pods') -%}
{% set pod_values = labels.get('_pod_values', {}) %}
{% if pod_values -%}
{% for pod in (labels.pods | unique | sort) -%}
pod: {{ pod }}{% if pod_values.get('pod:' + pod) %} (å€¼: {{ pod_values.get('pod:' + pod) }}){% endif %}
{% endfor %}
{%- else -%}
pod: {{ (labels.pods | unique | sort) | join(', ') }}
{%- endif %}
{% endif %}
{% if labels.get('replicas') -%}
replica: {{ (labels.replicas | unique | sort) | join(', ') }}
{% endif %}
{% endif %}

{% if annotations.summary -%}
summary: {{ annotations.summary }}
{%- endif %}